"""
–ú–æ–¥—É–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è IRT –∞–Ω–∞–ª–∏–∑–∞
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ IRT –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
"""

import streamlit as st
from modules.irt_analysis.person_item_map import create_person_item_map, create_irt_summary_stats, create_difficulty_by_type_boxplot
from modules.expert_system.expert_system import generate_expert_analysis


def display_irt_analysis(questions):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ IRT –∞–Ω–∞–ª–∏–∑–∞ —Å Person-Item Map"""
    questions = [q for q in questions if not q.get('is_main_question', False)]
    
    # –°–æ–∑–¥–∞–µ–º Person-Item Map
    try:
        person_item_fig = create_person_item_map(questions)
        st.plotly_chart(person_item_fig, use_container_width=True)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
        st.info("""
        **Person-Item Map** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–ø—Ä–æ—Å–æ–≤:
        - **–õ–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞**: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        - **–ü—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞**: —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤
        - **–ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**: –∫–æ–≥–¥–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è
        """)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–ø—Ä–∞–≤–∫—É –æ —à–∫–∞–ª–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –∏ —Ñ–æ—Ä–º—É–ª–µ –ª–æ–≥–∏—Ç–∞
        with st.expander("üìñ –°–ø—Ä–∞–≤–∫–∞: –ö–∞–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —à–∫–∞–ª–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –æ—Ç -4 –¥–æ +4"):
            st.markdown("""
            ### –®–∫–∞–ª–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –≤ IRT –∞–Ω–∞–ª–∏–∑–µ
            
            –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑–º–µ—Ä—è—é—Ç—Å—è –ø–æ **–ª–æ–≥–∏—Ç-—à–∫–∞–ª–µ** –æ—Ç **-4 –¥–æ +4**, –≥–¥–µ:
            - **-4 –¥–æ 0**: –Ω–∏–∑–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Å—Ç—É–¥–µ–Ω—Ç—ã —Å —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏ –≤ –æ—Å–≤–æ–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞)
            - **0**: —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
            - **0 –¥–æ +4**: –≤—ã—Å–æ–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Å—Ç—É–¥–µ–Ω—Ç—ã —Å –æ—Ç–ª–∏—á–Ω—ã–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞)
            
            ### –§–æ—Ä–º—É–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ –ª–æ–≥–∏—Ç-—à–∫–∞–ª—É
            
            –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ (Œ∏, —Ç–µ—Ç–∞) –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **–ª–æ–≥–∏—Ç-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
            
            $$
            \\theta = \\ln\\left(\\frac{p}{1-p}\\right)
            $$
            
            –≥–¥–µ:
            - **Œ∏ (—Ç–µ—Ç–∞)** ‚Äî —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –ª–æ–≥–∏—Ç-—à–∫–∞–ª–µ (–æ—Ç -4 –¥–æ +4)
            - **p** ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–æ—Ç 0 –¥–æ 1)
            - **ln** ‚Äî –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º
            
            ### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:
            
            1. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (p)**: 
               - –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ 50% –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Üí p = 0.5
               - –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ 90% –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Üí p = 0.9
               - –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ 10% –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Üí p = 0.1
            
            2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –ª–æ–≥–∏—Ç**:
               - p = 0.5 ‚Üí Œ∏ = ln(0.5/0.5) = ln(1) = **0** (—Å—Ä–µ–¥–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
               - p = 0.9 ‚Üí Œ∏ = ln(0.9/0.1) = ln(9) ‚âà **+2.2** (–≤—ã—Å–æ–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
               - p = 0.1 ‚Üí Œ∏ = ln(0.1/0.9) = ln(0.111) ‚âà **-2.2** (–Ω–∏–∑–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
            
            3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∫–∞–ª—ã**: 
               - –ó–Ω–∞—á–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º **-4 –¥–æ +4** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
               - –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º –æ—Ç ~1.8% (Œ∏ = -4) –¥–æ ~98.2% (Œ∏ = +4)
            
            ### –ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–≥–∏—Ç-—à–∫–∞–ª–∞?
            
            - **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å**: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏—Ç–∞—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö
            - **–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ—Å—Ç—å**: –ª–æ–≥–∏—Ç –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ª—é–±—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
            - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ª–µ–≥–∫–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
            
            ### –°–≤—è–∑—å —Å Person-Item Map
            
            –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ Person-Item Map:
            - **–õ–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (Œ∏)
            - **–ü—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤ (—Ç–∞–∫–∂–µ –≤ –ª–æ–≥–∏—Ç-—à–∫–∞–ª–µ)
            - –ö–æ–≥–¥–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–ø—Ä–æ—Å–æ–≤, —Å—Ç—É–¥–µ–Ω—Ç—ã –∏–º–µ—é—Ç ~50% —à–∞–Ω—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å
            """)
        
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Person-Item Map: {e}")
    
    # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    try:
        stats = create_irt_summary_stats(questions)
        if stats:
            col1, col2, col3 = st.columns(3)
            
            with col1:
                st.metric("–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤", stats['total_questions'])
                st.metric("–°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å", f"{stats['difficulty_mean']:.1f}%")
            
            with col2:
                easy_pct = (stats['easy_questions'] / stats['total_questions']) * 100 if stats['total_questions'] > 0 else 0
                medium_pct = (stats['medium_questions'] / stats['total_questions']) * 100 if stats['total_questions'] > 0 else 0
                st.metric("–õ–µ–≥–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã", f"{stats['easy_questions']} ({easy_pct:.1f}%)")
                st.metric("–°—Ä–µ–¥–Ω–∏–µ –≤–æ–ø—Ä–æ—Å—ã", f"{stats['medium_questions']} ({medium_pct:.1f}%)")
            
            with col3:
                hard_pct = (stats['hard_questions'] / stats['total_questions']) * 100 if stats['total_questions'] > 0 else 0
                st.metric("–°–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã", f"{stats['hard_questions']} ({hard_pct:.1f}%)")
                st.metric("–°—Ä–µ–¥–Ω—è—è –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è", f"{stats['discrimination_mean']:.2f}")
                
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {e}")
    
    # –°–æ–∑–¥–∞–µ–º boxplot —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ —Ç–∏–ø–∞–º –≤–æ–ø—Ä–æ—Å–æ–≤
    try:
        boxplot_fig = create_difficulty_by_type_boxplot(questions)
        if boxplot_fig.data:
            st.subheader("üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ —Ç–∏–ø–∞–º –≤–æ–ø—Ä–æ—Å–æ–≤")
            st.plotly_chart(boxplot_fig, use_container_width=True)
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ boxplot: {e}")
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    display_student_analysis(questions)


def display_student_analysis(questions):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"""
    
    st.subheader("üë• –ê–Ω–∞–ª–∏–∑ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤")
    
    try:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö
        expert_analysis = generate_expert_analysis(questions)
        
        if not expert_analysis:
            st.warning("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤")
            return
        
        # –ê–Ω–∞–ª–∏–∑ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        student_analysis = expert_analysis.get('student_analysis', {})
        if student_analysis:
            col1, col2, col3 = st.columns(3)
            
            with col1:
                st.metric(
                    "–°—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –Ω–∏–∑–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏", 
                    f"{student_analysis.get('low_ability_count', 0)} ({student_analysis.get('low_ability_percent', 0):.1f}%)",
                    help="–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –º–∏–Ω—É—Å –æ–¥–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ"
                )
            
            with col2:
                st.metric(
                    "–°—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å–æ —Å—Ä–µ–¥–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏", 
                    f"{student_analysis.get('medium_ability_count', 0)} ({student_analysis.get('medium_ability_percent', 0):.1f}%)",
                    help="–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ"
                )
            
            with col3:
                st.metric(
                    "–°—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏", 
                    f"{student_analysis.get('high_ability_count', 0)} ({student_analysis.get('high_ability_percent', 0):.1f}%)",
                    help="–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–ª—é—Å –æ–¥–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ"
                )
            
            # –¢–∏–ø —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º
            distribution_type = student_analysis.get('distribution_type', '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
            total_students = student_analysis.get('total_students', 0)
            st.info(f"**–¢–∏–ø —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π:** {distribution_type}")
            # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
            st.markdown(""" 
            **–¢–∏–ø—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:**
            - **–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ**: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–º–µ—é—Ç —Å—Ä–µ–¥–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            - **–°–º–µ—â–µ–Ω–Ω–æ–µ –≤–ª–µ–≤–æ**: –º–Ω–æ–≥–æ —Å–ª–∞–±—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
            - **–°–º–µ—â–µ–Ω–Ω–æ–µ –≤–ø—Ä–∞–≤–æ**: –º–Ω–æ–≥–æ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –º–æ–∂–Ω–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª    
            """)
            # –í–∞–∂–Ω–æ–µ –ø–æ—è—Å–Ω–µ–Ω–∏–µ –æ —Å–∏–º—É–ª—è—Ü–∏–∏
            st.warning(f"""
            **‚ö†Ô∏è –í–∞–∂–Ω–æ:** –î–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–∏–º—É–ª—è—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ –≤—Å–µ—Ö —É—á–µ–±–Ω—ã—Ö –≥—Ä—É–ø–ø, 
            –ø—Ä–æ—à–µ–¥—à–∏—Ö —Ç–µ—Å—Ç (‚âà{total_students} –ø–æ–ø—ã—Ç–æ–∫). –¢–∞–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–π –∫–∞—Ä—Ç–∏–Ω—ã –ø—Ä–æ–≤–æ–¥–∏–º–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
            """)
            
        else:
            st.warning("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤")
            
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {e}")
